---
l1idx: 1
l2idx: 3
title: "Symmetric Paths through Stateful Services"
permalink: 1_3.html
summary: "Routing Policy Framework For Multi-homed, multi-site topologies with multiple distributed network-security zones."
---

## The Problem to Solve

How do we maximize our flexibility in regards to the deployment of workloads in distinct network security zones at multiple sites, while:

 - Minimizing un-wanted traversal of stateful (firewall) inspection services on intra-zone traffic.
 - Avoiding un-wanted inter-site backhaul for inter-zone, intra-site traffic

## The Status Quo

 - We have multiple network-security zones with hosted workload.
   - Stateful inspection services are present on all inter-zone routing gateways
 - We have multiple sites, with most security-zones present at most sites
 - Inter-zone/inter-site routing is an ugly mess
    - Lots of intra-zone traffic going through firewalls (undesired)
    - Lots of manually maintained high-churn ip prefix-lists duplicated across all routers
       - Any subnet add/delete to any security zone at any site has to be reflected in multiple prefix-lists on multiple devices

## The Result

 - We apply a 99%-uniform set of route-maps to our routers
 - We get optimal pathing for all combinations of inter/intra site/zone flows.
   - Inter-zone traffic always traverses *one* firewall
   - Intra-zone traffic always traverses *no* firewalls
   - No ip prefix-list upkeep  (routes are tagged at origination instead)
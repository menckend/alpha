---
l1idx: 1
l2idx: 3
l3idx: 2
l4idx: 2
l5idx: 1
l6idx: 4
title: "Generalized/absracted conception"
permalink: 1_3_2_2_1_4.html
summary: "Is this an isolated corner-case, or is there a generalizable principle here?"
---

In order to generalize the issue(s?) at play here, we further formalize our model.  We will start by mapping the elements of our architecture to a formalized graph".  

# The reference topology
The two figures below illustrate a network with four network security zones (0-0.3), and four "sites" (0-0.3).  Site "0" represents a wide-area-network, and sites 0.1-0.3 represent separate metropolitan areas.  Zone "0" represents the "transit zone", and zones 0.1-0.3 represent separate workload-hosting zones.  This topology is depicted with isometric figures in order to help visualize the intersections of sites and security-zones .  In the first figure, "horizontal planes" contain all the nodes with a shared "site-ID" value, and "vertical columns" contain all the nodes with a shared "security-zone" value.  (Horizontal and vertical are reversed in the second figure)

{% capture details %}[![image](./grphth-3.svg){:class="img-fluid"}](./pages/1/3(ecmp-symmetric)/grphth-3.svg){:target="_blank"}
{% endcapture %}{% capture summary %}Isometric Figures{% endcapture %}{% include details.html %}

These two figure illustrate visually that "site" and "security zone" are treated *almost* identically in this framework.  We see the *mostly* the same  patterns visible when "zones" and "sites" are visually inverted.  The differences that we observe are as follows:
- Zone-0 differs from the other three zones
  - No stateful nodes exist in zone-0
- Site-0 differs from the other three sites
  - No stateful nodes exist in site-0
- Zone-0 differs from Site-0
  - Nodes in zone-0 form a tree with the zone-0/site-0 node at its root
  - There are *no* connections between two nodes in site-0

# Formalized Graph of the model network topology

## Elements
The BGP-speakers on our network are represented as nodes on the graph, and the links between them (transport+eBGP-session) are edges on the same graph.

## Properties

* Statefulness is a boolean value the describes whether or not a node tracks/enforces connection state for bi-directional traffic flows between two nodes.  Put more plainly, "whether the node will refuse to forward traffic if it does not "see" *both* flows in a bidirectional flow-pair between two other nodes.
* "Security-zone" is a label/tag used to identify nodes which may communicate with each other *without* passing through a "stateful" node.
  * Borrowing further from graph-theory, we will visually depict the security-zones on the graph by assigning a "color" to the nodes
* "Site" is a label/tag used to identify a group of nodes that are physically located in the same metropolitan area.
  * Site might also be regarded as a property of the edge that connects two nodes, assigning a "weight" to the edge that is representative of physical distance between the nodes that it connects

## Rules of Inference

We use the following rules of inference in building our graph (network topology):

  - All nodes have a "site-ID" and "zone-ID" property
  - Non-stateful nodes can only be connected to:
        - condition-1
            - Other non-stateful nodes with the same "zone-ID" property
          - or
            - Stateful nodes
      - and
        - condition-2
          - Nodes with the same site-ID value
        - or
          - Nodes with a site-ID value of "0"
  - Nodes can only be connected to:



# Miscellania

We can regard the network topologies described in the previous section as an undirected graph ( "G" ) , with the BGP-speaking routers/firewalls as nodes/vertices and the BGP sessions between them as edges.  The simplest-case is depicted below:

We can regard the selected path between an *ordered* pair ("P1") of nodes/vertices ("a,b") as a directed-graph ( "DG (P1)"  ) derived from "G".

We can regard the path selected for the *inversion* of ordered-pair "P1"  ()

We need a path-selection algorithm the will:
    - Result in selected paths for any two 

We can *describe* those paths based on the following properties:
- Source properties
  - The security-zone-ID (as a numeric value) in which the packet's source is located
  - The site-ID (as a numeric value) in which the packet's source is located
  - The number of stateful-hops in the packet's destination-site
- Destination properties
  - The security-zone-ID in which the packet's destination is located
  - The site-ID in which the packet's destination is located
  - The number of stateful-hops in the packet's destination-site
- In which site-ID(s) the packet traverses the transit-zone
- 
